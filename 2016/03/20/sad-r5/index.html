<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="一个逗比的碎碎念"><title>软件架构与设计 习题课 5 设计模式练习 | 小土刀</title><link rel="stylesheet" type="text/css" href="/css/normalize.css"><link rel="stylesheet" type="text/css" href="/css/pure-min.css"><link rel="stylesheet" type="text/css" href="/css/grids-responsive-min.css"><link rel="stylesheet" type="text/css" href="/css/style.css"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">软件架构与设计 习题课 5 设计模式练习</h1><a id="logo" href="/.">小土刀</a><p class="description">Agony is my triumph</p></div><div id="nav-menu"><a href="/." class="current"><i class="icon-home"> 首页</i></a><a href="/about/"><i class="icon-power-cord"> 技术</i></a><a href="/life/"><i class="icon-pacman"> 生活</i></a><a href="/portfolio/"><i class="icon-infinite"> 作品</i></a><a href="/archives/"><i class="icon-floppy-disk"> 归档</i></a><a href="/atom.xml"><i class="icon-rss"> 订阅</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post post-page"><h1 class="post-title">软件架构与设计 习题课 5 设计模式练习</h1><div class="post-meta">2016-03-20 | <span class="categories">分类于<a href="/categories/Technique/"> Technique</a></span></div><span data-thread-key="2016/03/20/sad-r5/" class="ds-thread-count"></span><div class="clear"><div id="toc" class="toc-article"><div class="toc-title">文章目录</div></div></div><div class="post-content"><p>这次的作业就是对设计模式的练习和熟悉，直接来看情境吧。</p>
<a id="more"></a>
<hr>
<blockquote>
<p>Does the following code fragment implement the Factory Method design pattern? Explain why.</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">XMLReaderFactory</span> </span>&#123;</span><br><span class="line">    <span class="comment">// This method returns an instance of a class</span></span><br><span class="line">    <span class="comment">// that implements the XMLReader interface.</span></span><br><span class="line">    <span class="comment">// The specific class it creates and returns is</span></span><br><span class="line">    <span class="comment">// based on a system property.</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> XMLReader <span class="title">createXMLReader</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">XMLReader</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setContentHandler</span><span class="params">(ContentHandler handler)</span>:</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">parse</span><span class="params">(InputStream is)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这部分代码片段实现了工厂模式，注释中说明是根据系统属性来进行创建，所以无须传入参数，需要被生成的对象都需要实现 XMLReader 接口。</p>
<blockquote>
<p>Typically, there is a significant performance penalty for declaring a method synchronized. In general adding the keyword synchronized to a method slows the invocation of the method by a factor of 6. A common programming idiom used to avoid synchronization in the common case is double check locking. Can the double-check locking idiom be used with the singleton pattern to avoid synchronizing every time the static instance method is called? For example, is the following valid? Explain why.</p>
</blockquote>
<p>```java<br>public class Singleton {<br>    private Singleton() { }<br>    static private Singleton instance = null;<br>    static public Singleton instance() {<br>        // Double check locking idiom<br>        // The synchronization is done internally<br>        // rather than on the method. This avoids<br>        // the expense of synchronizing for the<br>        // common case.<br>/<em>12</em>/  if( instance == null ) {<br>            synchronized( Singleton.class ) {<br>                // Second check<br>                if( instance == null ) {<br>/<em>16</em>/               instance = new Singleton( );<br>                 }<br>            }<br>        }<br>/<em>20</em>/  return instance;<br>    }<br>}</p>
<p>在大部分情况下代码没有问题，不过为了保险起见，还是要加上 <code>volatile</code> 关键字，不然在下面的情况中就会出问题：</p>
<ol>
<li>线程A发现变量没有被初始化, 然后它获取锁并开始变量的初始化。</li>
<li>由于某些编程语言的语义，编译器生成的代码允许在线程A执行完变量的初始化之前，更新变量并将其指向部分初始化的对象。</li>
<li>线程B发现共享变量已经被初始化，并返回变量。由于线程B确信变量已被初始化，它没有获取锁。如果在A完成初始化之前共享变量对B可见（这是由于A没有完成初始化或者因为一些初始化的值还没有穿过B使用的内存(缓存一致性)），程序很可能会崩溃。</li>
</ol>
<p><a href="https://zh.wikipedia.org/wiki/%E5%8F%8C%E9%87%8D%E6%A3%80%E6%9F%A5%E9%94%81%E5%AE%9A%E6%A8%A1%E5%BC%8F" target="_blank" rel="external">这里</a>有一个很好的参考资料</p>
<blockquote>
<p>Consider the following scenario, please suggest a design pattern and implement it. The outcome should like this:</p>
</blockquote>
<p><img src="/images/14585221758261.jpg" alt=""></p>
<p>In Elizabeth’s day care center, the teacher helps the kids to build all kinds of toys to develop their creative skills. One of Elizabeth’s favorite activities is to make animals with play-dough.</p>
<p>A set of molds is the tool that Elizabeth always uses to create her favorite cool animals.</p>
<p>One mold tool set includes five parts, including the head, body, arm, leg, and tail. Whenever Elizabeth wants to build an animal, she will use one set of each tools to make a head, body , leg, arm, and tail for that animal, and then assembles them with glue to build an animal. There are many types of animal mold tool sets that the kids can choose from.</p>
<p>For example: if Elizabeth wants to make a monkey, then she will pick the set of monkey molds to start.</p>
<ul>
<li>Step 1. Make monkey head.</li>
<li>Step 2. Make monkey body.</li>
<li>Step 3. Make monkey leg.</li>
<li>Step 4. Make monkey arm.</li>
<li>Step 5. Make monkey tail.</li>
</ul>
<p>Once all the five parts are finished, then Elizabeth will glue them all together and decorate it to have a monkey done as a finished product. Most likely, she will give it to her mom as a gift when she picks her (she will not give her the monkey if the monkey is not decorated, since it will not be looking good at all then). When she wants to make a kitten, she follows the same steps with the set of Kitten molds.</p>
<p>这道题目非常简单粗暴，看描述就知道直接使用建造者模式即可，具体的介绍看<a href="http://www.runoob.com/design-pattern/builder-pattern.html" target="_blank" rel="external">这里</a></p>
<p>实现的话这里就不贴代码了，反正是不难的。</p>
<blockquote>
<p>You are working on software that interacts with a new hardware device and are anxious to test against the actual hardware. The hardware manufacture has a beta version of the driver they plan to release but is warning the interface of the device driver could change between now and the release date. The device driver is used throughout your code and you are concerned about writing code to an interface that is subject to change. What design pattern can be used to mitigate the risks involved? Describe what the risks are and how the design pattern mitigates these risks.</p>
</blockquote>
<p>这个其实也比较简单，直觉反应就是适配器模式，用来做不同接口的转换。</p>
<blockquote>
<p>In keeping with the holiday theme, use the Decorator design pattern to model a Christmas tree as a base component (the tree) and optional decorations or adornments such as bulbs, candy and garland. Initially it’s enough for your solution to model just the printing or display of the tree along with its adornments. You can also assume that each type of decoration is added all at once.</p>
</blockquote>
<p><img src="/images/14585236303062.jpg" alt=""></p>
<p>Show the class diagram for your solution and the runtime organization of objects for different configurations of adornments.</p>
<p>这里题目已经指名说要用装饰器模式，就按照<a href="http://www.runoob.com/design-pattern/decorator-pattern.html" target="_blank" rel="external">这里</a>的方法设计一下即可，我就不啰嗦了。</p>
</div><div class="tags"><a href="/tags/CMU/">CMU</a><a href="/tags/习题/">习题</a><a href="/tags/架构/">架构</a><a href="/tags/设计/">设计</a></div><div class="post-nav"><a href="/2016/03/22/arch-build-1/" class="pre"><i class="icon-previous">架与构 1 缘起</i></a><a href="/2016/03/20/csapp-lab6/" class="next">深入理解计算机系统 习题课 6 Malloclab<i class="icon-next"></i></a></div><div data-thread-key="2016/03/20/sad-r5/" data-title="软件架构与设计 习题课 5 设计模式练习" data-url="http://wdxtub.com/2016/03/20/sad-r5/" class="ds-share flat"><div class="ds-share-inline"><ul class="ds-share-icons-16"><li data-toggle="ds-share-icons-more"><a href="javascript:void(0);" class="ds-more">分享到：</a></li><li><a href="javascript:void(0);" data-service="weibo" class="ds-weibo">微博</a></li><li><a href="javascript:void(0);" data-service="qzone" class="ds-qzone">QQ空间</a></li><li><a href="javascript:void(0);" data-service="qqt" class="ds-qqt">腾讯微博</a></li><li><a href="javascript:void(0);" data-service="wechat" class="ds-wechat">微信</a></li></ul><div class="ds-share-icons-more"></div></div></div><div data-thread-key="2016/03/20/sad-r5/" data-title="软件架构与设计 习题课 5 设计模式练习" data-url="http://wdxtub.com/2016/03/20/sad-r5/" data-author-key="1" class="ds-thread"></div></div></div></div><div class="pure-u-1-4"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search" class="search-form-input"/><input type="hidden" name="sitesearch" value="http://wdxtub.com"/></form></div><div class="widget"><div class="widget-title">分类</div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Game/">Game</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Gossip/">Gossip</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Memory/">Memory</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Movie/">Movie</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Reading/">Reading</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Story/">Story</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Technique/">Technique</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Thinking/">Thinking</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Traveling/">Traveling</a></li></ul></div><div class="widget"><div class="comments-title">最近评论</div><div data-num-items="5" data-show-avatars="0" data-show-time="1" data-show-admin="0" data-excerpt-length="32" data-show-title="1" class="ds-recent-comments"></div></div><div class="widget"><div class="widget-title">友情链接</div><ul></ul><a href="http://jackqdyulei.github.io" title="Lei YU" target="_blank">Lei YU</a><ul></ul><a href="http://wdxtub.com/library/" title="我的笔记" target="_blank">我的笔记</a><ul></ul><a href="http://wdxtub.com/bookclips/" title="我的书摘" target="_blank">我的书摘</a><ul></ul><a href="http://wdxtub.com/interview/" title="刷题笔记" target="_blank">刷题笔记</a></div></div></div></div><div id="footer">© <a href="/." rel="nofollow">小土刀.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div><a id="rocket" href="#top" class="show"></a><script src="/js/jquery.min.js" type="text/javascript"></script>
<script src="/js/totop.js" type="text/javascript"></script><script src="/js/fancybox.pack.js" type="text/javascript"></script>
<script src="/js/jquery.fancybox.js" type="text/javascript"></script><link rel="stylesheet" href="/css/jquery.fancybox.css" type="text/css"><script>var duoshuoQuery = {short_name:'wdxblog'};
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0]
        || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script></div></body></html>